{% extends "base.html" %}
{% block content %}
<div class="panel">
    <h2>Create new config</h2>
    <div class="actions">
        <a class="btn" href="{{ url_for('new_config') }}">New config (from scratch)</a>
        <a class="btn" href="{{ url_for('import_config') }}">Load existing config</a>
        <a class="btn" href="{{ url_for('list_configs') }}">Show defined configs</a>
    </div>
</div>

<div class="panel">
    <h2>List of defined configs</h2>
    <div class="scroll-wrap">
        <table class="table">
            <thead>
            <tr>
                <th>Config name</th>
                <th>Last modification</th>
                <th>Preview</th>
                <th>Edit</th>
                <th>Export</th>
                <th>Set as default</th>
                <th>Delete</th>
                <th>Is default</th>
            </tr>
            </thead>
            <tbody>
            {% for c in configs %}
            <tr>
                <td>{{ c.name }}</td>
                <td>{{ c.updated_at.strftime("%Y-%m-%d %H:%M:%S") }}</td>
                <td><a class="btn btn-small" href="{{ url_for('view_config', config_id=c.id) }}">Preview</a></td>
                <td><a class="btn btn-small" href="{{ url_for('edit_config', config_id=c.id) }}">Edit</a></td>
                <td><a class="btn btn-small" href="{{ url_for('export_config', config_id=c.id) }}">Export</a></td>
                <td>
                    <button class="btn btn-small"
                            hx-post="{{ url_for('set_active_config', config_id=c.id) }}"
                            hx-swap="none"
                            hx-on="htmx:afterRequest: window.location.reload()">
                        Set as default
                    </button>
                </td>
                <td>
                    <form method="post" action="{{ url_for('delete_config', config_id=c.id) }}" class="inline">
                        <button class="btn btn-small danger" type="submit"
                                onclick="return confirm('Are you sure you want to delete config {{ c.name }}?');">
                            Delete
                        </button>
                    </form>
                </td>
                <td class="nowrap">
                    {% if c.is_active %}<span class="badge">DEFAULT</span>{% else %}-{% endif %}
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="8" class="muted">No configuration found.</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}